<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML>
<HEAD>
<TITLE>Enscript Output</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#1F00FF" ALINK="#FF0000" VLINK="#9900DD">
<A NAME="top">
<H1>Contents</H1>
<OL>
  <LI><A HREF="#file1">simul.py</A>
</OL>
<HR>
<A NAME="file1">
<H1>simul.py</H1>

<PRE>
<B><FONT COLOR="#A020F0">import</FONT></B> numpy as np
<B><FONT COLOR="#A020F0">import</FONT></B> math


<B><FONT COLOR="#A020F0">class</FONT></B> Simul:
    <B><FONT COLOR="#BC8F8F">&quot;&quot;&quot; 
    This is the prototype of the simulation code
    It moves the particles with at velocity, using a vector notation: numpy should be used.
    &quot;&quot;&quot;</FONT></B>
    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__init__</FONT></B>(self, simul_time, sigma, L):
        np.seterr(all=<B><FONT COLOR="#BC8F8F">'ignore'</FONT></B>)  <I><FONT COLOR="#B22222"># remove errors in where statements
</FONT></I>        self.position = np.array([[2., 2.], [5., 2.], [2., 5.], [5., 5.]])  <I><FONT COLOR="#B22222"># starting positions
</FONT></I>        self.velocity = 3*np.random.normal(size=self.position.shape)  <I><FONT COLOR="#B22222"># random velocities
</FONT></I>        self.l, self.m = np.triu_indices(self.position.shape[0], k=1)  <I><FONT COLOR="#B22222"># all pairs of indices between particles
</FONT></I>        self.sigma = sigma  <I><FONT COLOR="#B22222"># particle radius
</FONT></I>        self.simul_time = simul_time
        self.L = L

    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">wall_time</FONT></B>(self):
        first_collision_time = np.inf
        particle = np.inf
        direction = np.inf
        <B><FONT COLOR="#A020F0">return</FONT></B> first_collision_time, particle, direction
        <I><FONT COLOR="#B22222"># calculate time of first collision, particle involved and direction
</FONT></I>
    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">pair_time</FONT></B>(self):
        <B><FONT COLOR="#A020F0">pass</FONT></B>

    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">md_step</FONT></B>(self):
        <B><FONT COLOR="#A020F0">print</FONT></B>(<B><FONT COLOR="#BC8F8F">'Simul::md_step'</FONT></B>)
        ke_start = (self.velocity**2).sum()/2.   <I><FONT COLOR="#B22222"># starting kinetic energy
</FONT></I>
        pressure = -1
        current_time = 0
        condition_on_time_variables = False

        w_time, particle, direction = self.wall_time()

        <B><FONT COLOR="#A020F0">while</FONT></B> condition_on_time_variables:   <I><FONT COLOR="#B22222"># think about this
</FONT></I>            <I><FONT COLOR="#B22222"># do something
</FONT></I>            w_time, particle, direction = self.wall_time()  <I><FONT COLOR="#B22222"># update collisions times
</FONT></I>            <I><FONT COLOR="#B22222"># update current_time
</FONT></I>
        <I><FONT COLOR="#B22222"># adapt the position update  as a function of your logic
</FONT></I>        self.position += self.simul_time * self.velocity

        <B><FONT COLOR="#A020F0">assert</FONT></B> math.isclose(ke_start,  (self.velocity**2).sum()/2.)  <I><FONT COLOR="#B22222"># check that we conserve energy after all the collisions
</FONT></I>
        <B><FONT COLOR="#A020F0">return</FONT></B> pressure

    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__str__</FONT></B>(self):   <I><FONT COLOR="#B22222"># this is used to print the position and velocity of the particles
</FONT></I>        p = np.array2string(self.position)
        v = np.array2string(self.velocity)
        <B><FONT COLOR="#A020F0">return</FONT></B> <B><FONT COLOR="#BC8F8F">'pos= '</FONT></B>+p+<B><FONT COLOR="#BC8F8F">'\n'</FONT></B>+<B><FONT COLOR="#BC8F8F">'vel= '</FONT></B>+v+<B><FONT COLOR="#BC8F8F">'\n'</FONT></B>
</PRE>
<HR>
<ADDRESS>Generated by <A HREF="http://www.iki.fi/~mtr/genscript/">GNU Enscript 1.6.6</A>.</ADDRESS>
</BODY>
</HTML>
